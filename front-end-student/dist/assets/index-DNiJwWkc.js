import{j as e,r as k,a as Ie}from"./react-DH8gkkhY.js";import{c as Ye}from"./react-dom-BYO5wvSL.js";import{J as Y,H as le,F as He,c as Xe,Y as Qe,Z as ce,t as X,d as Ze,r as de,a as et,b as q,h as tt,s as ot,m as rt,e as Q,o as Ee,x as st,n as nt,f as at,g as it,A as oe,Q as Ne,X as re,i as lt,j as ct,k as dt,l as pt,z as mt,D as ut,S as gt,p as se,q as xt,u as ht,G as ft,_ as yt,v as jt,N as vt}from"./@refinedev-B1B9nM3c.js";import{t as P,L as w,S as D,T as f,a as K,G as pe,M as F,b as z,d as St,s as Ae,A as bt,R as _,k as I,o as Ct,I as B,C as R,p as A,D as Fe,f as wt,F as v}from"./antd-BmkwGqfY.js";import{L as kt,D as We,R as Pt,a as Tt,U as Be,B as Lt,an as It,f as G}from"./@ant-design-OtiXosd2.js";import{L as Oe,B as Et}from"./react-router-dom-BKHS1xSL.js";import{d as me,W as Nt,a as At,L as Bt}from"./dayjs-B00B7Pht.js";import{d as Ot}from"./lodash-EdlTNsCV.js";import{T as zt,c as Rt}from"./antd-style-BiCmN7vj.js";import{n as Mt}from"./@emotion-VKejVevr.js";import{u as Ht,i as Ft}from"./react-i18next-Czpf8ZlE.js";import{f as Wt,g as L,O as ne}from"./react-router-Cv5WbiS5.js";import{i as Dt}from"./i18next-CNvWw4cZ.js";import{B as qt}from"./i18next-xhr-backend-A5wqzlCQ.js";import{B as _t}from"./i18next-browser-languagedetector-Bkz_uJ-G.js";import"./scheduler-CzFDRTuY.js";import"./kbar-DiUQAh-2.js";import"./fast-equals-CrnhxdxQ.js";import"./tiny-invariant-CCEyh0dg.js";import"./fuse.js-BiqRfhjd.js";import"./@radix-ui-ByavxYOX.js";import"./@babel-BaQnMuoD.js";import"./react-virtual-v1C_eaEV.js";import"./sunflower-antd-CV4BdbUI.js";import"./tslib-rrx6G-_s.js";import"./react-markdown-DuNMWXub.js";import"./vfile-fzL750Th.js";import"./vfile-message-Yxcn4erv.js";import"./unist-util-stringify-position-DoPE_uaZ.js";import"./unified-DX0a-VcR.js";import"./bail-SStH00At.js";import"./extend-jtEkKnIJ.js";import"./trough-jSDOhjDI.js";import"./remark-parse-ly6Tk_Kz.js";import"./mdast-util-from-markdown-CzVY6DM7.js";import"./micromark-CzzHGSuL.js";import"./mdast-util-to-string-C0X7pjc9.js";import"./remark-rehype-B7K5eLTG.js";import"./mdast-util-to-hast-BruFuaQU.js";import"./mdurl-C8CUtoe4.js";import"./unist-builder-tpcLhTJa.js";import"./unist-util-visit-parents-Cg8WeLrx.js";import"./unist-util-is-DwpaFvQX.js";import"./unist-util-generated-C8XodnwN.js";import"./mdast-util-definitions-C_7RTOdj.js";import"./prop-types-BKNjMPK8.js";import"./property-information-Cytp7ONK.js";import"./xtend-CeaPpq3n.js";import"./space-separated-tokens-CMBzgJJ4.js";import"./comma-separated-tokens-DgTuumFk.js";import"./style-to-object-BJgLatKQ.js";import"./inline-style-parser-D--Rb2MU.js";import"./remark-gfm-uuFT1UzZ.js";import"./micromark-extension-gfm-C2pub1qt.js";import"./micromark-extension-gfm-autolink-literal-bX9_pU3b.js";import"./micromark-extension-gfm-table-CWMNnI7g.js";import"./micromark-extension-gfm-task-list-item-D_63skcW.js";import"./micromark-extension-gfm-strikethrough-BPcHxx-h.js";import"./mdast-util-gfm-sKjnyyop.js";import"./mdast-util-gfm-autolink-literal-BlrXkJGm.js";import"./mdast-util-find-and-replace-BIfOqU6k.js";import"./escape-string-regexp-BdPwSnSr.js";import"./mdast-util-gfm-strikethrough-CsZDDlv_.js";import"./mdast-util-to-markdown-CNf13Pp0.js";import"./repeat-string-CuhouN3Z.js";import"./mdast-util-gfm-table-MDCrFMD8.js";import"./markdown-table-CS3BmPel.js";import"./mdast-util-gfm-task-list-item-tYGaKol0.js";import"./error-stack-parser-D-HSrqU0.js";import"./stackframe-CRiyT9t-.js";import"./lodash-es-7KURb3zo.js";import"./qs-GQdXSFHX.js";import"./side-channel-63rqoWE7.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./call-bind-Aj7T_c8u.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./object-inspect-HEtH4kEc.js";import"./warn-once-4BjjRnyK.js";import"./pluralize-D_AWglm3.js";import"./papaparse-DJ2HzFup.js";import"./@tanstack-DujLlojC.js";import"./use-sync-external-store-C6gDz3eG.js";import"./@remix-run-D2Wyhr0w.js";import"./query-string-SCOpAa9y.js";import"./strict-uri-encode-DdzwWRIL.js";import"./decode-uri-component-CROxjmim.js";import"./split-on-first-BNP3K2Fc.js";import"./filter-obj-DG2z_hf8.js";import"./axios-Cm0UX6qg.js";import"./rc-util-CWnEaukB.js";import"./classnames-Bswp8e6k.js";import"./rc-resize-observer-DKP4nymf.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-B3L3gIwS.js";import"./rc-select-JCo4VFju.js";import"./rc-overflow-KNkZQU_l.js";import"./@rc-component-BKYvW6s0.js";import"./rc-virtual-list-_gdJBi5Y.js";import"./@ctrl-DOFZgDuz.js";import"./rc-dropdown-Dcb9U2MV.js";import"./rc-menu-VTuF76_v.js";import"./rc-tabs-B_oKIIGx.js";import"./rc-checkbox-W4bHprR1.js";import"./rc-drawer-BA9Kht8k.js";import"./rc-field-form-DytDjwqV.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-image-BcstU_jO.js";import"./rc-dialog-CfCGpmfe.js";import"./throttle-debounce-CWhimLW_.js";import"./rc-notification-BTVfavw-.js";import"./rc-tooltip-mAQUr1i7.js";import"./rc-textarea-DEIgPhwW.js";import"./rc-input-CFZnkGuS.js";import"./copy-to-clipboard-DVhNznM9.js";import"./toggle-selection-BHUZwh74.js";import"./rc-upload-CmWWiz1U.js";import"./rc-pagination-DMlALvU-.js";import"./rc-picker-Co7R0rPB.js";import"./rc-progress-DnZcgY35.js";import"./swr-CYAy5F2c.js";import"./stylis-TWPHNfLu.js";import"./use-merge-value-CyoWPz7c.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function d(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=d(r);fetch(r.href,o)}})();const W="/assets/ams_logo-CXlI1sfo.svg",$t=({isSticky:t,sticky:s})=>{const{token:d}=P.useToken(),n=Y(),{data:r}=le({v3LegacyAuthProviderCompatible:!!(n!=null&&n.isLegacy)});if(!(r&&(r.name||r.avatar)))return null;const a={backgroundColor:d.colorBgElevated,display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0px 24px",height:"64px"};return He(s,t)&&(a.position="sticky",a.top=0,a.zIndex=1),e.jsx(w.Header,{style:a,children:e.jsx(D,{children:e.jsxs(D,{size:"middle",children:[(r==null?void 0:r.name)&&e.jsx(f.Text,{strong:!0,children:r.name}),(r==null?void 0:r.avatar)&&e.jsx(K,{src:r==null?void 0:r.avatar,alt:r==null?void 0:r.name})]})})})},Jt={borderTopLeftRadius:0,borderBottomLeftRadius:0,position:"fixed",top:64,zIndex:999},Vt=({Title:t,render:s,meta:d,fixed:n,activeItemDisabled:r=!1})=>{const{token:o}=P.useToken(),{siderCollapsed:a,setSiderCollapsed:u,mobileSiderOpen:c,setMobileSiderOpen:g}=Xe(),j=Qe(),x=ce(),y=X(),{warnWhen:p,setWarnWhen:l}=Ze(),{Link:m}=de(),i=x==="legacy"?m:y,S=et(),b=q(),{menuItems:C,selectedKey:E,defaultOpenKeys:$}=tt({meta:d}),h=pe.useBreakpoint(),{hasDashboard:T}=ot(),M=Y(),{mutate:O}=rt({v3LegacyAuthProviderCompatible:!!(M!=null&&M.isLegacy)}),qe=typeof h.lg>"u"?!1:!h.lg,ye=t??S??Q,je=(J,V)=>J.map(N=>{const{icon:we,label:ke,route:Ve,key:Ge,name:Pe,children:Z,parentName:Ue,meta:ee,options:te}=N;if(Z.length>0)return e.jsx(Ee,{resource:Pe.toLowerCase(),action:"list",params:{resource:N},children:e.jsx(F.SubMenu,{icon:we??e.jsx(Be,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),title:ke,children:je(Z,V)},N.key)},N.key);const Te=Ge===V,Ke=!(He(ee==null?void 0:ee.parent,te==null?void 0:te.parent,Ue)!==void 0&&Z.length===0),Le=r&&Te?{pointerEvents:"none"}:{};return e.jsx(Ee,{resource:Pe.toLowerCase(),action:"list",params:{resource:N},children:e.jsxs(F.Item,{icon:we??(Ke&&e.jsx(Be,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),style:Le,children:[e.jsx(i,{to:Ve??"",style:Le,children:ke}),!a&&Te&&e.jsx("div",{className:"ant-menu-tree-arrow"})]},N.key)},N.key)}),_e=()=>{p?window.confirm(b("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes."))&&(l(!1),O()):O()},ve=j&&e.jsx(F.Item,{onClick:()=>_e(),icon:e.jsx(kt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:b("buttons.logout","Logout")},"logout"),Se=T?e.jsxs(F.Item,{icon:e.jsx(We,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:[e.jsx(i,{to:"/",children:b("dashboard.title","Dashboard")}),!a&&E==="/"&&e.jsx("div",{className:"ant-menu-tree-arrow"})]},"dashboard"):null,be=je(C,E),$e=()=>s?s({dashboard:Se,items:be,logout:ve,collapsed:a}):e.jsxs(e.Fragment,{children:[Se,be,ve]}),Ce=()=>e.jsx(F,{selectedKeys:E?[E]:[],defaultOpenKeys:$,mode:"inline",style:{paddingTop:"8px",border:"none",overflow:"auto",height:"calc(100% - 72px)"},onClick:()=>{g(!1)},children:$e()}),Je=()=>e.jsxs(e.Fragment,{children:[e.jsx(St,{open:c,onClose:()=>g(!1),placement:"left",closable:!1,width:200,bodyStyle:{padding:0},maskClosable:!0,children:e.jsx(w,{children:e.jsxs(w.Sider,{style:{height:"100vh",backgroundColor:o.colorBgContainer,borderRight:`1px solid ${o.colorBgElevated}`},children:[e.jsx("div",{style:{width:"200px",padding:"0 16px",display:"flex",justifyContent:"flex-start",alignItems:"center",height:"64px",backgroundColor:o.colorBgElevated},children:e.jsx(ye,{collapsed:!1})}),Ce()]})})}),e.jsx(z,{style:Jt,size:"large",onClick:()=>g(!0),icon:e.jsx(Lt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})]});if(qe)return Je();const H={backgroundColor:o.colorBgContainer,borderRight:`1px solid ${o.colorBgElevated}`};return n&&(H.position="fixed",H.top=0,H.height="100vh",H.zIndex=999),e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{style:{width:a?"80px":"200px",transition:"all 0.2s"}}),e.jsxs(w.Sider,{style:H,collapsible:!0,collapsed:a,onCollapse:(J,V)=>{V==="clickTrigger"&&u(J)},collapsedWidth:80,breakpoint:"lg",trigger:e.jsx(z,{type:"text",style:{borderRadius:0,height:"100%",width:"100%",backgroundColor:o.colorBgElevated},children:a?e.jsx(Pt,{style:{color:o.colorPrimary},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):e.jsx(Tt,{style:{color:o.colorPrimary},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),children:[e.jsx("div",{style:{width:a?"80px":"200px",padding:a?"0":"0 16px",display:"flex",justifyContent:a?"center":"flex-start",alignItems:"center",height:"64px",backgroundColor:o.colorBgElevated,fontSize:"14px"},children:e.jsx(ye,{collapsed:a})}),Ce()]})]})},ze=({children:t,Header:s,Sider:d,Title:n,Footer:r,OffLayoutArea:o,initialSiderCollapsed:a})=>{const u=pe.useBreakpoint(),c=d??Vt,g=s??$t,j=typeof u.sm>"u"?!0:u.sm,x=!!c({Title:n});return e.jsx(st,{initialSiderCollapsed:a,children:e.jsxs(w,{style:{minHeight:"100vh"},hasSider:x,children:[e.jsx(c,{Title:n}),e.jsxs(w,{children:[e.jsx(g,{}),e.jsxs(w.Content,{children:[e.jsx("div",{style:{minHeight:360,padding:j?24:12},children:t}),o&&e.jsx(o,{})]}),r&&e.jsx(r,{})]})]})})},Gt=()=>{localStorage.setItem("auto_login","false")},ae="attendance-auth",Ut={login:async({reference:t,password:s})=>{if(t&&s){const d=await fetch("https://knust-ams.up.railway.app/api/student-login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})}),n=await d.json();if(d.status===200)return localStorage.setItem(ae,JSON.stringify({id:n.id,reference:n.reference,index:n.index,name:n.name,year:n.year,total_strike:n.total_strike,user:n.user,programme:n.programme})),{success:!0,redirectTo:"/"}}return{success:!1,error:{name:"Student Login Fail",message:"Invalid reference or password"}}},updatePassword:async()=>(Ae.success({message:"Updated Password",description:"Password updated successfully"}),{success:!0}),forgotPassword:async({email:t})=>(Ae.success({message:"Reset Password",description:`Reset password link sent to "${t}"`}),{success:!0}),logout:async()=>(Gt(),localStorage.clear(),document.cookie.split(";").forEach(t=>{document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/")}),{success:!0,redirectTo:"/student-login"}),onError:async t=>{var s;return((s=t.response)==null?void 0:s.status)===401?{logout:!0}:{error:t}},check:async()=>localStorage.getItem(ae)?{authenticated:!0}:{authenticated:!1,error:{message:"Check failed",name:"Token not found"},logout:!0,redirectTo:"/login"},getPermissions:async()=>null,getIdentity:async()=>{const t=localStorage.getItem(ae);if(t){const s=JSON.parse(t);return{id:s.id,name:s.name,email:s.email,avatar:s.avatar,index:s.index}}return null}},De=k.createContext(void 0),Kt=localStorage.getItem("theme")||"light",Yt=({theme:t,children:s})=>{const[d,n]=k.useState(Kt),r=o=>{localStorage.setItem("theme",o);const a=document.querySelector("html");a==null||a.setAttribute("data-theme",o),n(o)};return k.useEffect(()=>{const o=document.querySelector("html");o==null||o.setAttribute("data-theme",d)},[]),e.jsx(De.Provider,{value:{mode:d,setMode:r},children:e.jsx(bt,{theme:{...nt.Orange,algorithm:d==="light"?P.defaultAlgorithm:P.darkAlgorithm,...t},children:e.jsx(zt,{appearance:d,children:s})})})},Xt=()=>{const t=k.useContext(De);if(t===void 0)throw new Error("useConfigProvider must be used within a ConfigProvider");return t},Qt=Rt(({token:t})=>({headerTitle:{display:"flex",justifyContent:"space-between",fontSize:"14px",fontWeight:"bold",borderBottom:"1px"},inputSuffix:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:t.colorBgTextHover,color:t.colorTextDisabled,borderRadius:"4px",fontSize:"12px"},inputPrefix:{color:t.colorTextPlaceholder,marginRight:"4px"},languageSwitchText:{color:t.colorTextSecondary},languageSwitchIcon:{color:t.colorTextTertiary,width:"10px"},themeSwitch:{display:"flex",alignItems:"center",justifyContent:"center",height:"32px",width:"32px",borderRadius:"50%",cursor:"pointer",backgroundColor:t.colorBgTextHover},userName:{display:"flex !important",color:t.colorTextHeading,fontSize:"14px"}})),{Header:Zt}=w,{useToken:eo}=P,{Text:ie}=f,{useBreakpoint:to}=pe,Re=()=>{const{token:t}=eo(),{styles:s}=Qt();Xt();const{i18n:d}=Ht(),n=at(),r=it(),{data:o}=le(),a=to(),u=q();n();const c=l=>e.jsxs("div",{className:s.headerTitle,children:[e.jsx(ie,{style:{fontSize:"16px"},children:l}),e.jsx(Oe,{to:`/${l.toLowerCase()}`,children:u("search.more")})]}),g=(l,m,i)=>({value:l,label:e.jsxs(Oe,{to:i,style:{display:"flex",alignItems:"center"},children:[m&&e.jsx(K,{size:32,src:m,style:{minWidth:"32px",marginRight:"16px"}}),e.jsx(ie,{children:l})]})}),[j,x]=k.useState(""),[y,p]=k.useState([]);return oe({resource:"orders",config:{filters:[{field:"q",operator:"contains",value:j}]},queryOptions:{enabled:!1,onSuccess:l=>{const m=l.data.map(i=>{var S,b,C;return g(`${i.store.title} / #${i.orderNumber}`,((C=(b=(S=i==null?void 0:i.products)==null?void 0:S[0].images)==null?void 0:b[0])==null?void 0:C.url)||"/images/default-order-img.png",`/orders/show/${i.id}`)});m.length>0&&p(i=>[...i,{label:c(u("orders.orders")),options:m}])}}}),oe({resource:"stores",config:{filters:[{field:"q",operator:"contains",value:j}]},queryOptions:{enabled:!1,onSuccess:l=>{const m=l.data.map(i=>g(i.title,"",`/stores/edit/${i.id}`));m.length>0&&p(i=>[...i,{label:c(u("stores.stores")),options:m}])}}}),oe({resource:"couriers",config:{filters:[{field:"q",operator:"contains",value:j}]},queryOptions:{enabled:!1,onSuccess:l=>{const m=l.data.map(i=>g(`${i.name} ${i.surname}`,i.avatar[0].url,`/couriers/show/${i.id}`));m.length>0&&p(i=>[...i,{label:c(u("couriers.couriers")),options:m}])}}}),k.useEffect(()=>{},[j]),[...d.languages||[]].sort().map(l=>({key:l,onClick:()=>r(l),icon:e.jsx("span",{style:{marginRight:8},children:e.jsx(K,{size:16,src:`/images/flags/${l}.svg`})}),label:l==="en"?"English":"German"})),e.jsx(Zt,{style:{backgroundColor:t.colorBgElevated,padding:"0 24px"},children:e.jsxs(_,{align:"middle",style:{justifyContent:a.sm?"space-between":"end"},children:[e.jsx(I,{xs:0,sm:8,md:12,children:e.jsx(Ct,{style:{width:"100%",maxWidth:"550px"},options:y,filterOption:!1,onSearch:Ot(l=>x(l),300),children:e.jsx(B,{size:"large",placeholder:u("search.placeholder"),suffix:e.jsx("div",{className:s.inputSuffix,children:"/"}),prefix:e.jsx(It,{className:s.inputPrefix,onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})}),e.jsx(I,{children:e.jsx(D,{size:a.md?32:16,align:"center",children:e.jsxs(D,{size:a.md?16:8,align:"center",children:[e.jsx(ie,{ellipsis:!0,className:s.userName,children:o==null?void 0:o.name}),e.jsx(K,{size:"large",src:o==null?void 0:o.avatar,alt:o==null?void 0:o.name})]})})})]})})},oo="/assets/knust-mobile-VbPX6VIz.svg",ro=Mt.div`
    height: 72px;
    display: flex;
    justify-content: center;
    align-items: center;
`,Me=({collapsed:t})=>{P.useToken();const s=X();return e.jsx(ro,{children:e.jsx(s,{to:"/",children:t?e.jsx("img",{src:oo,style:{width:"30px"},alt:"logo_mobile"}):e.jsx(D,{size:12,children:e.jsx("img",{src:W,alt:"logo",style:{width:"130px"}})})})})},so=t=>e.jsx(R,{styles:{header:{padding:"16px 16px 10px 16px",minHeight:"max-content",borderBottom:0,cursor:"pointer"},body:{padding:"24px 16px 24px 24px",cursor:"pointer",...(t==null?void 0:t.bodyStyles)||{}}},title:e.jsxs(A,{align:"center",justify:"space-between",children:[e.jsxs(A,{gap:8,children:[t.icon,e.jsx(f.Text,{style:{fontWeight:400},children:t.title})]}),t==null?void 0:t.rightSlot]}),onClick:t.handleClick,children:t.children}),no=()=>{var E,$;const{data:t}=le(),{token:s}=P.useToken(),{mutate:d,data:n,isLoading:r}=Ne(),{mutate:o,data:a,isLoading:u,isError:c}=Ne(),[g,j]=k.useState(""),[x,y]=k.useState(!0);c&&(y(h=>!h),localStorage.setItem("attendanceToggle","true"),localStorage.removeItem("verificationCode"));const p=localStorage.getItem("storedData")!="undefined"||!localStorage.getItem("storedData")?JSON.parse(localStorage.getItem("storedData")):{data:{courses:{id:"N/A",code:"N/A",name:"N/A",expiration_time:"N/A"},session:{id:"N/A",expiration_time:"N/A"}}};k.useEffect(()=>{const h=localStorage.getItem("storedData");(h=="undefined"||!h)&&localStorage.setItem("storedData",JSON.stringify(n))},[n]);const l=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async h=>{const T=h.coords.latitude,M=h.coords.longitude;try{d({resource:`verification_api/${t==null?void 0:t.id}/`,values:{verificationcode:g,latitude:T,longitude:M}},{onSuccess:()=>{y(O=>!O),localStorage.setItem("attendanceToggle","false"),localStorage.setItem("verificationCode",JSON.stringify({code:g}))}})}catch(O){console.log(O.message)}},h=>{console.log("Error getting location:",h)}):console.log("Geolocation is not supported by this browser.")},m=async()=>{if(n!=null)try{o({resource:`MarkAttendance/${t==null?void 0:t.id}/${g}/`,values:{}},{onSuccess:()=>{y(h=>!h),localStorage.removeItem("attendanceToggle"),JSON.parse(localStorage.getItem("attendanceMarked"))?localStorage.setItem("attendanceMarked","false"):localStorage.setItem("attendanceMarked","true"),localStorage.removeItem("storedData"),localStorage.removeItem("verificationCode")}})}catch(h){console.log("Error marking attendance:",h)}else{const h=localStorage.getItem("verificationCode");try{o({resource:`MarkAttendance/${t==null?void 0:t.id}/${h}`,values:{attendance_type:"start"}},{onSuccess:()=>{localStorage.removeItem("attendanceToggle"),JSON.parse(localStorage.getItem("attendanceMarked"))?localStorage.setItem("attendanceMarked","false"):localStorage.setItem("attendanceMarked","true"),localStorage.removeItem("verificationCode"),localStorage.removeItem("storedData"),y(T=>!T)},onError:()=>{y(T=>!T),localStorage.setItem("attendanceToggle","false"),localStorage.removeItem("verificationCode")}})}catch(T){console.log("Error marking attendance:",T)}}},i=((E=n==null?void 0:n.data)==null?void 0:E.courses)??{id:"N/A",name:"N/A",code:"N/A"},S=(($=n==null?void 0:n.data)==null?void 0:$.session)??{id:"N/A",expiration_time:"N/A"},b=new Date(S.expiration_time).toLocaleTimeString(),C=new Date(p==null?void 0:p.data.session.expiration_time).toLocaleTimeString();return console.log(JSON.parse(localStorage.getItem("attendanceToggle"))),e.jsxs(e.Fragment,{children:[e.jsx(f.Title,{style:{fontSize:25},children:"Mark Attendance"}),e.jsx(Fe,{}),e.jsx(wt,{spinning:r,children:e.jsxs(_,{gutter:32,wrap:!0,children:[!localStorage.getItem("attendanceToggle")&&x||JSON.parse(localStorage.getItem("attendanceToggle"))!=!1&&x?e.jsx(I,{xs:24,md:12,lg:9,style:{marginTop:64},children:e.jsxs(R,{styles:{body:{padding:50}},children:[e.jsx(v.Item,{name:"verificationcode",label:"Verification Code",rules:[{required:!0},{message:"Invalid Vefication code"}],children:e.jsx(B,{onChange:h=>j(h.currentTarget.value),size:"large",placeholder:"Verification Code"})}),e.jsx(re,{style:{marginLeft:"auto",width:"100%"},htmlType:"submit",onClick:l,type:"primary",icon:e.jsx(G,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:"Verify"})]})}):e.jsx(I,{xs:24,md:12,lg:9,style:{marginTop:64},children:e.jsxs(R,{styles:{body:{padding:30}},children:[e.jsx(f.Text,{style:{fontStyle:"italic",color:"grey"},children:"Note: Use the start button if this is the first session verification of the class otherwise use the end button"}),e.jsxs(A,{gap:30,style:{marginTop:35},children:[e.jsx(re,{style:{marginLeft:"auto",width:"100%",backgroundColor:"green"},htmlType:"submit",onClick:m,disabled:JSON.parse(localStorage.getItem("attendanceMarked")),type:"primary",icon:e.jsx(G,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:"Start"}),e.jsx(re,{style:{marginLeft:"auto",width:"100%",backgroundColor:"red"},disabled:JSON.parse(localStorage.getItem("attendanceMarked"))!=!0,htmlType:"submit",onClick:m,type:"primary",icon:e.jsx(G,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:"End"})]})]})}),e.jsx(I,{xs:24,md:12,lg:12,style:{height:"432px",marginTop:"64px"},children:e.jsxs(so,{icon:e.jsx(G,{style:{fontSize:14,color:s.colorPrimary},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),bodyStyles:{padding:"37px"},title:"Verified Course",children:[e.jsxs(A,{style:{justifyContent:"space-between",marginBottom:"15px"},children:[e.jsx(f,{style:{fontSize:16,fontWeight:600},children:"Course Code"}),e.jsx(f.Text,{children:i.code!="N/A"?i.code:p==null?void 0:p.data.courses.code})]}),e.jsxs(A,{style:{justifyContent:"space-between",marginBottom:"15px"},children:[e.jsx(f,{style:{fontSize:16,fontWeight:600},children:"Course"}),e.jsx(f.Text,{children:i.name!="N/A"?i.name:p==null?void 0:p.data.courses.name})]}),e.jsxs(A,{style:{justifyContent:"space-between",marginBottom:"15px"},children:[e.jsx(f,{style:{fontSize:16,fontWeight:600},children:"Session number"}),e.jsx(f.Text,{children:S.id!="N/A"?S.id:p==null?void 0:p.data.session.id})]}),e.jsxs(A,{style:{justifyContent:"space-between"},children:[e.jsx(f,{style:{fontSize:16,fontWeight:600},children:"Code expiration time"}),e.jsx(f.Text,{children:S.expiration_time!="N/A"?b:C})]})]})})]})})]})},ao=()=>e.jsx(no,{}),ue={},ge={maxWidth:"400px",margin:"auto",padding:"32px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.02), 0px 1px 6px -1px rgba(0, 0, 0, 0.02), 0px 1px 2px rgba(0, 0, 0, 0.03)"},xe={borderBottom:0,padding:0},he={padding:0,marginTop:"32px"},fe={textAlign:"center",marginBottom:0,fontSize:"24px",lineHeight:"32px",fontWeight:700,overflowWrap:"break-word",hyphens:"manual",textOverflow:"unset",whiteSpace:"pre-wrap"},io=({providers:t,forgotPasswordLink:s,rememberMe:d,contentProps:n,wrapperProps:r,renderContent:o,formProps:a,title:u,hideForm:c})=>{const{token:g}=P.useToken(),[j]=v.useForm(),x=q();ce(),X(),de();const y=Y(),{mutate:p,isLoading:l}=lt({v3LegacyAuthProviderCompatible:!!(y!=null&&y.isLegacy)}),m=u===!1?null:e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"32px",fontSize:"20px"},children:u??e.jsx(Q,{collapsed:!1})}),i=e.jsx(f.Title,{level:3,style:{color:g.colorPrimaryTextHover,...fe},children:x("Student Login")}),S=()=>t&&t.length>0?e.jsxs(e.Fragment,{children:[t.map(C=>e.jsx(z,{type:"default",block:!0,icon:C.icon,style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",marginBottom:"8px"},onClick:()=>p({providerName:C.name}),children:C.label},C.name)),!c&&e.jsx(Fe,{children:e.jsx(f.Text,{style:{color:g.colorTextLabel},children:x("pages.login.divider","or")})})]}):null,b=e.jsxs(R,{title:e.jsx(e.Fragment,{children:i}),headStyle:xe,bodyStyle:he,style:{...ge,backgroundColor:g.colorBgElevated},...n??{},children:[S(),!c&&e.jsxs(v,{layout:"vertical",form:j,onFinish:C=>p(C),requiredMark:!1,initialValues:{remember:!1},...a,children:[e.jsx(v.Item,{name:"reference",label:x("Reference"),rules:[{required:!0},{message:x("Invalid reference number")}],children:e.jsx(B,{size:"large",placeholder:x("Reference number")})}),e.jsx(v.Item,{name:"password",label:x("pages.login.fields.password","Password"),rules:[{required:!0}],children:e.jsx(B,{type:"password",autoComplete:"current-password",placeholder:"●●●●●●●●",size:"large"})}),!c&&e.jsx(v.Item,{children:e.jsx(z,{type:"primary",size:"large",htmlType:"submit",loading:l,block:!0,children:x("Login")})})]})]});return e.jsx(w,{style:ue,...r??{},children:e.jsx(_,{justify:"center",align:c?"top":"middle",style:{padding:"16px 0",minHeight:"100dvh",paddingTop:c?"15dvh":"16px"},children:e.jsx(I,{xs:22,children:o?o(b,m):e.jsxs(e.Fragment,{children:[m,b]})})})})},lo=({loginLink:t,wrapperProps:s,contentProps:d,renderContent:n,formProps:r,title:o})=>{const{token:a}=P.useToken(),[u]=v.useForm(),c=q(),g=ce(),j=X(),{Link:x}=de(),y=g==="legacy"?x:j,{mutate:p,isLoading:l}=ct(),m=o===!1?null:e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"32px",fontSize:"20px"},children:o??e.jsx(Q,{collapsed:!1})}),i=e.jsx(f.Title,{level:3,style:{color:a.colorPrimaryTextHover,...fe},children:c("pages.forgotPassword.title","Forgot your password?")}),S=e.jsx(R,{title:i,headStyle:xe,bodyStyle:he,style:{...ge,backgroundColor:a.colorBgElevated},...d??{},children:e.jsxs(v,{layout:"vertical",form:u,onFinish:b=>p(b),requiredMark:!1,...r,children:[e.jsx(v.Item,{name:"email",label:c("pages.forgotPassword.fields.email","Email"),rules:[{required:!0},{type:"email",message:c("pages.forgotPassword.errors.validEmail","Invalid email address")}],children:e.jsx(B,{type:"email",size:"large",placeholder:c("pages.forgotPassword.fields.email","Email")})}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:t??e.jsxs(f.Text,{style:{fontSize:12,marginLeft:"auto"},children:[c("pages.register.buttons.haveAccount","Have an account? ")," ",e.jsx(y,{style:{fontWeight:"bold",color:a.colorPrimaryTextHover},to:"/login",children:c("pages.login.signin","Sign in")})]})}),e.jsx(v.Item,{style:{marginTop:"24px",marginBottom:0},children:e.jsx(z,{type:"primary",size:"large",htmlType:"submit",loading:l,block:!0,children:c("pages.forgotPassword.buttons.submit","Send reset instructions")})})]})});return e.jsx(w,{style:ue,...s??{},children:e.jsx(_,{justify:"center",align:"middle",style:{padding:"16px 0",minHeight:"100dvh"},children:e.jsx(I,{xs:22,children:n?n(S,m):e.jsxs(e.Fragment,{children:[m,S]})})})})},co=({wrapperProps:t,contentProps:s,renderContent:d,formProps:n,title:r})=>{const{token:o}=P.useToken(),[a]=v.useForm(),u=q(),c=Y(),{mutate:g,isLoading:j}=dt({v3LegacyAuthProviderCompatible:!!(c!=null&&c.isLegacy)}),x=r===!1?null:e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"32px",fontSize:"20px"},children:r??e.jsx(Q,{collapsed:!1})}),y=e.jsx(f.Title,{level:3,style:{color:o.colorPrimaryTextHover,...fe},children:u("pages.updatePassword.title","Set New Password")}),p=e.jsx(R,{title:y,headStyle:xe,bodyStyle:he,style:{...ge,backgroundColor:o.colorBgElevated},...s??{},children:e.jsxs(v,{layout:"vertical",form:a,onFinish:l=>g(l),requiredMark:!1,...n,children:[e.jsx(v.Item,{name:"password",label:u("pages.updatePassword.fields.password","New Password"),rules:[{required:!0}],style:{marginBottom:"12px"},children:e.jsx(B,{type:"password",placeholder:"●●●●●●●●",size:"large"})}),e.jsx(v.Item,{name:"confirmPassword",label:u("pages.updatePassword.fields.confirmPassword","Confirm New Password"),hasFeedback:!0,dependencies:["password"],rules:[{required:!0},({getFieldValue:l})=>({validator(m,i){return!i||l("password")===i?Promise.resolve():Promise.reject(new Error(u("pages.updatePassword.errors.confirmPasswordNotMatch","Passwords do not match")))}})],children:e.jsx(B,{type:"password",placeholder:"●●●●●●●●",size:"large"})}),e.jsx(v.Item,{style:{marginBottom:0},children:e.jsx(z,{type:"primary",size:"large",htmlType:"submit",loading:j,block:!0,children:u("pages.updatePassword.buttons.submit","Update")})})]})});return e.jsx(w,{style:ue,...t??{},children:e.jsx(_,{justify:"center",align:"middle",style:{padding:"16px 0",minHeight:"100dvh"},children:e.jsx(I,{xs:22,children:d?d(p,x):e.jsxs(e.Fragment,{children:[x,p]})})})})},U=t=>{const{type:s}=t,d=()=>{switch(s){case"forgotPassword":return e.jsx(lo,{...t});case"updatePassword":return e.jsx(co,{...t});default:return e.jsx(io,{...t})}};return e.jsx(e.Fragment,{children:d()})},po=()=>{const s=vt("https://knust-ams.up.railway.app/api");return e.jsx(Et,{children:e.jsx(Yt,{theme:{token:{colorPrimary:"#A2121C"}},children:e.jsx(pt,{children:e.jsxs(mt,{routerProvider:ut,dataProvider:s,authProvider:Ut,options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0},notificationProvider:gt,resources:[{name:"dashboard",list:"/",meta:{label:"Dashboard",icon:e.jsx(We,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}}],children:[e.jsxs(Wt,{children:[e.jsx(L,{element:e.jsx(se,{fallback:e.jsx(xt,{to:"/student-login"}),children:e.jsx(ze,{Header:Re,Title:Me,children:e.jsx("div",{style:{maxWidth:"1200px",marginLeft:"auto",marginRight:"auto"},children:e.jsx(ne,{})})})},"authenticated-routes"),children:e.jsx(L,{index:!0,element:e.jsx(ao,{})})}),e.jsxs(L,{element:e.jsx(se,{fallback:e.jsx(ne,{}),children:e.jsx(ht,{resource:"dashboard"})},"auth-pages"),children:[e.jsx(L,{path:"/student-login",element:e.jsx(U,{title:e.jsx("img",{src:W,alt:"logo"}),type:"login"})}),e.jsx(L,{path:"/lecturer-login",element:e.jsx(U,{title:e.jsx("img",{src:W,alt:"logo"}),type:"register"})}),e.jsx(L,{path:"/forgot-password",element:e.jsx(U,{title:e.jsx("img",{src:W,alt:"logo"}),type:"forgotPassword"})}),e.jsx(L,{path:"/update-password",element:e.jsx(U,{title:e.jsx("img",{src:W,alt:"logo"}),type:"updatePassword"})})]}),e.jsx(L,{element:e.jsx(se,{children:e.jsx(ze,{Header:Re,Title:Me,children:e.jsx(ne,{})})},"catch-all"),children:e.jsx(L,{path:"*",element:e.jsx(ft,{})})})]}),e.jsx(yt,{}),e.jsx(jt,{})]})})})})};Dt.use(qt).use(_t).use(Ft).init({supportedLngs:["en","de"],backend:{loadPath:"/locales/{{lng}}.json"},fallbackLng:["en","de"]});me.extend(Nt);me.extend(At);me.extend(Bt);const mo=document.getElementById("root"),uo=Ye(mo);uo.render(e.jsx(Ie.StrictMode,{children:e.jsx(Ie.Suspense,{fallback:null,children:e.jsx(po,{})})}));
