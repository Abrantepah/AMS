import{h as ee,c as te,g as ne,b as re}from"./@babel-1b4b41ae.js";import{T as ae}from"./@rc-component-cd4aaefc.js";import{c as S}from"./classnames-25d76406.js";import{m as oe,K as L,h as W,s as D}from"./rc-util-c5d9a97a.js";import{r as b,a as n}from"./react-f83171f6.js";var ie=L.ESC,le=L.TAB;function se(e){var u=e.visible,o=e.triggerRef,s=e.onVisibleChange,c=e.autoFocus,r=e.overlayRef,a=b.useRef(!1),f=function(){if(u){var t,i;(t=o.current)===null||t===void 0||(i=t.focus)===null||i===void 0||i.call(t),s==null||s(!1)}},p=function(){var t;return(t=r.current)!==null&&t!==void 0&&t.focus?(r.current.focus(),a.current=!0,!0):!1},h=function(t){switch(t.keyCode){case ie:f();break;case le:{var i=!1;a.current||(i=p()),i?t.preventDefault():f();break}}};b.useEffect(function(){return u?(window.addEventListener("keydown",h),c&&oe(p,3),function(){window.removeEventListener("keydown",h),a.current=!1}):function(){a.current=!1}},[u])}var fe=b.forwardRef(function(e,u){var o=e.overlay,s=e.arrow,c=e.prefixCls,r=b.useMemo(function(){var f;return typeof o=="function"?f=o():f=o,f},[o]),a=W(u,r==null?void 0:r.ref);return n.createElement(n.Fragment,null,s&&n.createElement("div",{className:"".concat(c,"-arrow")}),n.cloneElement(r,{ref:D(r)?a:void 0}))}),v={adjustX:1,adjustY:1},d=[0,0],ue={topLeft:{points:["bl","tl"],overflow:v,offset:[0,-4],targetOffset:d},top:{points:["bc","tc"],overflow:v,offset:[0,-4],targetOffset:d},topRight:{points:["br","tr"],overflow:v,offset:[0,-4],targetOffset:d},bottomLeft:{points:["tl","bl"],overflow:v,offset:[0,4],targetOffset:d},bottom:{points:["tc","bc"],overflow:v,offset:[0,4],targetOffset:d},bottomRight:{points:["tr","br"],overflow:v,offset:[0,4],targetOffset:d}},ce=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function ve(e,u){var o,s=e.arrow,c=s===void 0?!1:s,r=e.prefixCls,a=r===void 0?"rc-dropdown":r,f=e.transitionName,p=e.animation,h=e.align,m=e.placement,t=m===void 0?"bottomLeft":m,i=e.placements,$=i===void 0?ue:i,_=e.getPopupContainer,j=e.showAction,K=e.hideAction,B=e.overlayClassName,H=e.overlayStyle,q=e.visible,A=e.trigger,M=A===void 0?["hover"]:A,I=e.autoFocus,E=e.overlay,y=e.children,w=e.onVisibleChange,X=ee(e,ce),Y=n.useState(),N=te(Y,2),z=N[0],x=N[1],O="visible"in e?q:z,P=n.useRef(null),T=n.useRef(null),V=n.useRef(null);n.useImperativeHandle(u,function(){return P.current});var k=function(l){x(l),w==null||w(l)};se({visible:O,triggerRef:V,onVisibleChange:k,autoFocus:I,overlayRef:T});var G=function(l){var C=e.onOverlayClick;x(!1),C&&C(l)},F=function(){return n.createElement(fe,{ref:T,overlay:E,prefixCls:a,arrow:c})},J=function(){return typeof E=="function"?F:F()},Q=function(){var l=e.minOverlayWidthMatchTrigger,C=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?l:!C},U=function(){var l=e.openClassName;return l!==void 0?l:"".concat(a,"-open")},Z=n.cloneElement(y,{className:S((o=y.props)===null||o===void 0?void 0:o.className,O&&U()),ref:D(y)?W(V,y.ref):void 0}),R=K;return!R&&M.indexOf("contextMenu")!==-1&&(R=["click"]),n.createElement(ae,ne({builtinPlacements:$},X,{prefixCls:a,ref:P,popupClassName:S(B,re({},"".concat(a,"-show-arrow"),c)),popupStyle:H,action:M,showAction:j,hideAction:R,popupPlacement:t,popupAlign:h,popupTransitionName:f,popupAnimation:p,popupVisible:O,stretch:Q()?"minWidth":"",popup:J(),onPopupVisibleChange:k,onPopupClick:G,getPopupContainer:_}),Z)}const ye=n.forwardRef(ve);export{ye as D};
